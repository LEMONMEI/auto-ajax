webpackJsonp([0],{"047C":function(e,t){},"0U9i":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={name:"UserProfile",components:{BulkRegistration:a("VQCX").default},data:function(){return{users:[],roles:[],dialogFormVisible:!1,selectedUser:[],selectedRolesIds:[]}},mounted:function(){this.listUsers(),this.listRoles()},computed:{tableHeight:function(){return window.innerHeight-320}},methods:{listUsers:function(){var e=this;this.$axios.get("/admin/user").then(function(t){t&&200===t.data.code&&(e.users=t.data.result)})},listRoles:function(){var e=this;this.$axios.get("/admin/role").then(function(t){t&&200===t.data.code&&(e.roles=t.data.result)})},commitStatusChange:function(e,t){var a=this;"admin"!==t.username?this.$axios.put("/admin/user/status",{enabled:e,username:t.username}).then(function(o){o&&200===o.data.code&&(e?a.$message("用户 ["+t.username+"] 已启用"):a.$message("用户 ["+t.username+"] 已禁用"))}):(t.enabled=!0,this.$alert("不能禁用管理员账户"))},onSubmit:function(e){for(var t=this,a=[],o=0;o<this.selectedRolesIds.length;o++)for(var l=0;l<this.roles.length;l++)this.selectedRolesIds[o]===this.roles[l].id&&a.push(this.roles[l]);this.$axios.put("/admin/user",{username:e.username,name:e.name,phone:e.phone,email:e.email,roles:a}).then(function(e){e&&200===e.data.code&&(t.$alert("用户信息修改成功"),t.dialogFormVisible=!1,t.listUsers())})},editUser:function(e){this.dialogFormVisible=!0,this.selectedUser=e;for(var t=[],a=0;a<e.roles.length;a++)t.push(e.roles[a].id);this.selectedRolesIds=t},resetPassword:function(e){var t=this;this.$axios.put("/admin/user/password",{username:e}).then(function(e){e&&200===e.data.code&&t.$alert("密码已重置为 123")})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"修改用户信息",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",staticStyle:{"text-align":"left"},model:{value:e.selectedUser,callback:function(t){e.selectedUser=t},expression:"selectedUser"}},[a("el-form-item",{attrs:{label:"用户名","label-width":"120px",prop:"username"}},[a("label",[e._v(e._s(e.selectedUser.username))])]),e._v(" "),a("el-form-item",{attrs:{label:"真实姓名","label-width":"120px",prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.selectedUser.name,callback:function(t){e.$set(e.selectedUser,"name",t)},expression:"selectedUser.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号","label-width":"120px",prop:"phone"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.selectedUser.phone,callback:function(t){e.$set(e.selectedUser,"phone",t)},expression:"selectedUser.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱","label-width":"120px",prop:"email"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.selectedUser.email,callback:function(t){e.$set(e.selectedUser,"email",t)},expression:"selectedUser.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码","label-width":"120px",prop:"password"}},[a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.resetPassword(e.selectedUser.username)}}},[e._v("重置密码")])],1),e._v(" "),a("el-form-item",{attrs:{label:"角色分配","label-width":"120px",prop:"roles"}},[a("el-checkbox-group",{model:{value:e.selectedRolesIds,callback:function(t){e.selectedRolesIds=t},expression:"selectedRolesIds"}},e._l(e.roles,function(t,o){return a("el-checkbox",{key:o,attrs:{label:t.id}},[e._v(e._s(t.nameZh))])}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit(e.selectedUser)}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-row",{staticStyle:{margin:"18px 0px 0px 18px"}},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/admin/dashboard"}}},[e._v("管理中心")]),e._v(" "),a("el-breadcrumb-item",[e._v("用户管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("用户信息")])],1)],1),e._v(" "),a("bulk-registration",{on:{onSubmit:function(t){return e.listUsers()}}}),e._v(" "),a("el-card",{staticStyle:{margin:"18px 2%",width:"95%"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users,stripe:"","default-sort":{prop:"id",order:"ascending"},"max-height":e.tableHeight}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"id",sortable:"",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"用户名",fit:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"真实姓名",fit:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号",fit:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱","show-overflow-tooltip":"",fit:""}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",sortable:"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){return e.commitStatusChange(a,t.row)}},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"scope.row.enabled"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.editUser(t.row)}}},[e._v("\n            编辑\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"}},[e._v("\n            移除\n          ")])]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"20px 0 20px 0",float:"left"}},[a("el-button",[e._v("取消选择")]),e._v(" "),a("el-button",[e._v("批量删除")])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(o,l,!1,function(e){a("NkPI")},"data-v-1e952794",null);t.default=r.exports},"8zNu":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={name:"BookManagement",components:{EditForm:a("EYD5").default},data:function(){return{books:[]}},mounted:function(){this.loadBooks()},computed:{tableHeight:function(){return window.innerHeight-320}},methods:{deleteBook:function(e){var t=this;this.$confirm("此操作将永久删除该书籍, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/admin/content/books/delete",{id:e}).then(function(e){e&&200===e.data.code&&t.loadBooks()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},editBook:function(e){this.$refs.edit.dialogFormVisible=!0,this.$refs.edit.form={id:e.id,cover:e.cover,title:e.title,author:e.author,date:e.date,press:e.press,abs:e.abs,category:{id:e.category.id.toString(),name:e.category.name}}},loadBooks:function(){var e=this;this.$axios.get("/books").then(function(t){t&&200===t.data.code&&(e.books=t.data.result)})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticStyle:{margin:"18px 0px 0px 18px"}},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/admin/dashboard"}}},[e._v("管理中心")]),e._v(" "),a("el-breadcrumb-item",[e._v("内容管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("图书管理")])],1)],1),e._v(" "),a("edit-form",{ref:"edit",on:{onSubmit:function(t){return e.loadBooks()}}}),e._v(" "),a("el-card",{staticStyle:{margin:"18px 2%",width:"95%"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.books,stripe:"","max-height":e.tableHeight}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{attrs:{"label-position":"left",inline:""}},[a("el-form-item",[a("span",[e._v(e._s(t.row.abs))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"书名（展开查看摘要）",fit:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"category.name",label:"分类",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"author",label:"作者",fit:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"date",label:"出版日期",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"press",label:"出版社",fit:""}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.editBook(t.row)}}},[e._v("\n            编辑\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteBook(t.row.id)}}},[e._v("\n            移除\n          ")])]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"20px 0 20px 0",float:"left"}},[a("el-button",[e._v("取消选择")]),e._v(" "),a("el-button",[e._v("批量删除")])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(o,l,!1,function(e){a("YoAZ")},"data-v-68ddec06",null);t.default=r.exports},B870:function(e,t){},EYD5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={name:"EditForm",components:{ImgUpload:a("1vuj").default},data:function(){return{dialogFormVisible:!1,form:{id:"",title:"",author:"",date:"",press:"",cover:"",abs:"",cid:"",category:{id:"",name:""}},formLabelWidth:"120px"}},methods:{clear:function(){this.$refs.imgUpload.clear(),this.form={id:"",title:"",author:"",date:"",press:"",cover:"",abs:"",category:{id:"",name:""}}},onSubmit:function(){var e=this;this.$axios.post("/admin/content/books",{id:this.form.id,cover:this.form.cover,title:this.form.title,author:this.form.author,date:this.form.date,press:this.form.press,abs:this.form.abs,category:this.form.category}).then(function(t){t&&200===t.data.code&&(e.dialogFormVisible=!1,e.$emit("onSubmit"))})},uploadImg:function(){this.form.cover=this.$refs.imgUpload.url}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"text-align":"left"}},[a("el-button",{staticClass:"add-button",attrs:{type:"success"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加图书")]),e._v(" "),a("el-dialog",{attrs:{title:"添加/修改图书",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.clear}},[a("el-form",{ref:"dataForm",staticStyle:{"text-align":"left"},model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("el-form-item",{attrs:{label:"书名","label-width":e.formLabelWidth,prop:"title"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"不加《》"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"作者","label-width":e.formLabelWidth,prop:"author"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.author,callback:function(t){e.$set(e.form,"author",t)},expression:"form.author"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"出版日期","label-width":e.formLabelWidth,prop:"date"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"出版社","label-width":e.formLabelWidth,prop:"press"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.press,callback:function(t){e.$set(e.form,"press",t)},expression:"form.press"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"封面","label-width":e.formLabelWidth,prop:"cover"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"图片 URL"},model:{value:e.form.cover,callback:function(t){e.$set(e.form,"cover",t)},expression:"form.cover"}}),e._v(" "),a("img-upload",{ref:"imgUpload",on:{onUpload:e.uploadImg}})],1),e._v(" "),a("el-form-item",{attrs:{label:"简介","label-width":e.formLabelWidth,prop:"abs"}},[a("el-input",{attrs:{type:"textarea",autocomplete:"off"},model:{value:e.form.abs,callback:function(t){e.$set(e.form,"abs",t)},expression:"form.abs"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分类","label-width":e.formLabelWidth,prop:"cid"}},[a("el-select",{attrs:{placeholder:"请选择分类"},model:{value:e.form.category.id,callback:function(t){e.$set(e.form.category,"id",t)},expression:"form.category.id"}},[a("el-option",{attrs:{label:"文学",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"流行",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"文化",value:"3"}}),e._v(" "),a("el-option",{attrs:{label:"生活",value:"4"}}),e._v(" "),a("el-option",{attrs:{label:"经管",value:"5"}}),e._v(" "),a("el-option",{attrs:{label:"科技",value:"6"}})],1)],1),e._v(" "),a("el-form-item",{staticStyle:{height:"0"},attrs:{prop:"id"}},[a("el-input",{attrs:{type:"hidden",autocomplete:"off"},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(o,l,!1,function(e){a("H9Me")},"data-v-f4311048",null);t.default=r.exports},H9Me:function(e,t){},NkPI:function(e,t){},VQCX:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"text-align":"left"}},[a("el-button",{staticClass:"add-button",attrs:{type:"success"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("批量添加用户")]),e._v(" "),a("el-dialog",{attrs:{title:"添加用户",visible:e.dialogFormVisible,width:"25%"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.clear}},[a("el-form",{attrs:{model:e.loginForm,rules:e.rules,"label-position":"left","label-width":"0px"}},[a("el-form-item",{attrs:{prop:"username"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"账号"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"真实姓名"},model:{value:e.loginForm.name,callback:function(t){e.$set(e.loginForm,"name",t)},expression:"loginForm.name"}})],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"电话号码"},model:{value:e.loginForm.phone,callback:function(t){e.$set(e.loginForm,"phone",t)},expression:"loginForm.phone"}})],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"E-Mail"},model:{value:e.loginForm.email,callback:function(t){e.$set(e.loginForm,"email",t)},expression:"loginForm.email"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"40%",background:"#505458",border:"none"},attrs:{type:"primary"},on:{click:e.register}},[e._v("添加")])],1)],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")({name:"BulkRegistration",data:function(){return{dialogFormVisible:!1,rules:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]},loginForm:{username:"",password:"",name:"",phone:"",email:""}}},methods:{clear:function(){this.loginForm={username:"",password:"",name:"",phone:"",email:""}},register:function(){var e=this;this.$axios.post("/register",{username:this.loginForm.username,password:this.loginForm.password,name:this.loginForm.name,phone:this.loginForm.phone,email:this.loginForm.email}).then(function(t){200===t.data.code?(e.$alert("注册成功","提示",{confirmButtonText:"确定"}),e.clear(),e.$emit("onSubmit")):e.$alert(t.data.message,"提示",{confirmButtonText:"确定"})}).catch(function(e){})}}},o,!1,function(e){a("047C")},"data-v-65a6a495",null);t.default=l.exports},VcZY:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticStyle:{margin:"18px 0px 0px 18px"}},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/admin/dashboard"}}},[e._v("管理中心")]),e._v(" "),a("el-breadcrumb-item",[e._v("内容管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("图书管理")])],1)],1),e._v(" "),a("el-card",{staticStyle:{margin:"18px 2%",width:"95%"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:""}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"广告名称",fit:""}}),e._v(" "),a("el-table-column",{attrs:{label:"链接地址",fit:""}}),e._v(" "),a("el-table-column",{attrs:{label:"图片地址",fit:""}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"}},[e._v("\n            编辑\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"}},[e._v("\n            移除\n          ")])]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"20px 0 20px 0",float:"left"}},[a("el-button",[e._v("取消选择")]),e._v(" "),a("el-button",[e._v("批量删除")])],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")({name:"BannerManagement"},o,!1,function(e){a("g2TA")},"data-v-62969dd4",null);t.default=l.exports},Y7Bk:function(e,t){},YoAZ:function(e,t){},cdRC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"text-align":"left"}},[a("el-button",{staticClass:"add-button",attrs:{type:"success"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加角色")]),e._v(" "),a("el-dialog",{attrs:{title:"添加角色",visible:e.dialogFormVisible,width:"25%"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.clear}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{model:e.roleForm,rules:e.rules,"label-position":"left","label-width":"0px"}},[a("el-form-item",{attrs:{prop:"name"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"角色名"},model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"nameZh"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"角色描述"},model:{value:e.roleForm.nameZh,callback:function(t){e.$set(e.roleForm,"nameZh",t)},expression:"roleForm.nameZh"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"40%",background:"#505458",border:"none"},attrs:{type:"primary"},on:{click:e.createRole}},[e._v("添加")])],1),e._v(" "),a("el-form-item",{attrs:{prop:"username"}},[a("el-tag",[e._v("初始权限：无")])],1)],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")({name:"RoleCreate",data:function(){return{dialogFormVisible:!1,rules:{name:[{required:!0,message:"角色名不能为空",trigger:"blur"}]},checked:!0,roleForm:{name:"",nameZh:""},loading:!1}},methods:{clear:function(){this.roleForm={name:"",nameZh:""}},createRole:function(){var e=this;this.$axios.post("/admin/role",{name:this.roleForm.name,nameZh:this.roleForm.nameZh}).then(function(t){200===t.data.code?(e.$alert(t.data.result,"提示",{confirmButtonText:"确定"}),e.clear(),e.$emit("onSubmit")):e.$alert(t.data.message,"提示",{confirmButtonText:"确定"})}).catch(function(e){}),this.dialogFormVisible=!1}}},o,!1,function(e){a("B870")},"data-v-121cdd98",null);t.default=l.exports},g2TA:function(e,t){},phcO:function(e,t){},pmqU:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={name:"UserRole",components:{RoleCreate:a("cdRC").default},data:function(){return{dialogFormVisible:!1,roles:[],perms:[],menus:[],selectedRole:[],selectedPermsIds:[],selectedMenusIds:[],props:{id:"id",label:"nameZh",children:"children"}}},mounted:function(){this.listRoles(),this.listPerms(),this.listMenus()},computed:{tableHeight:function(){return window.innerHeight-320}},methods:{listRoles:function(){var e=this;this.$axios.get("/admin/role").then(function(t){t&&200===t.status&&(e.roles=t.data.result)})},listPerms:function(){var e=this;this.$axios.get("/admin/role/perm").then(function(t){t&&200===t.data.code&&(e.perms=t.data.result)})},listMenus:function(){var e=this;this.$axios.get("/admin/role/menu").then(function(t){t&&200===t.data.code&&(e.menus=t.data.result)})},commitStatusChange:function(e,t){var a=this;1!==t.id?this.$confirm("是否更改角色状态？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$axios.put("/admin/role/status",{enabled:e,id:t.id}).then(function(o){o&&200===o.data.code&&(e?a.$message("角色 ["+t.nameZh+"] 已启用"):a.$message("角色 ["+t.nameZh+"] 已禁用"))})}).catch(function(){t.enabled=!t.enabled,a.$message({type:"info",message:"已取消"})}):(t.enabled=!0,this.$alert("无法禁用系统管理员！"))},editRole:function(e){this.dialogFormVisible=!0,this.selectedRole=e;for(var t=[],a=0;a<e.perms.length;a++)t.push(e.perms[a].id);this.selectedPermsIds=t;for(var o=[],l=0;l<e.menus.length;l++){o.push(e.menus[l].id);for(var r=0;r<e.menus[l].children.length;r++)o.push(e.menus[l].children[r].id)}this.selectedMenusIds=o,this.$refs.tree&&this.$refs.tree.setCheckedKeys(o)},onSubmit:function(e){for(var t=this,a=[],o=0;o<this.selectedPermsIds.length;o++)for(var l=0;l<this.perms.length;l++)this.selectedPermsIds[o]===this.perms[l].id&&a.push(this.perms[l]);this.$axios.put("/admin/role",{id:e.id,name:e.name,nameZh:e.nameZh,enabled:e.enabled,perms:a}).then(function(e){e&&200===e.data.code&&(t.$alert(e.data.result),t.dialogFormVisible=!1,t.listRoles())}),this.$axios.put("/admin/role/menu?rid="+e.id,{menusIds:this.$refs.tree.getCheckedKeys()}).then(function(e){e&&200===e.data.code&&console.log(e.data.result)})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"修改角色信息",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",staticStyle:{"text-align":"left"},model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}},[a("el-form-item",{attrs:{label:"角色名","label-width":"120px",prop:"username"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.selectedRole.name,callback:function(t){e.$set(e.selectedRole,"name",t)},expression:"selectedRole.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色描述","label-width":"120px",prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.selectedRole.nameZh,callback:function(t){e.$set(e.selectedRole,"nameZh",t)},expression:"selectedRole.nameZh"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"功能配置","label-width":"120px",prop:"perms"}},[a("el-checkbox-group",{model:{value:e.selectedPermsIds,callback:function(t){e.selectedPermsIds=t},expression:"selectedPermsIds"}},e._l(e.perms,function(t,o){return a("el-checkbox",{key:o,attrs:{label:t.id}},[e._v(e._s(t.desc_))])}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"菜单配置","label-width":"120px",prop:"menus"}},[a("el-tree",{ref:"tree",attrs:{data:e.menus,props:e.props,"show-checkbox":"","default-checked-keys":e.selectedMenusIds,"node-key":"id"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit(e.selectedRole)}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-row",{staticStyle:{margin:"18px 0px 0px 18px"}},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/admin/dashboard"}}},[e._v("管理中心")]),e._v(" "),a("el-breadcrumb-item",[e._v("用户管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("角色配置")])],1)],1),e._v(" "),a("role-create",{on:{onSubmit:function(t){return e.listRoles()}}}),e._v(" "),a("el-card",{staticStyle:{margin:"18px 2%",width:"95%"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roles,stripe:"","max-height":e.tableHeight}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"id",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"角色名",fit:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"nameZh",label:"角色描述",fit:""}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){return e.commitStatusChange(a,t.row)}},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"scope.row.enabled"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.editRole(t.row)}}},[e._v("\n            编辑\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"}},[e._v("\n            移除\n          ")])]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"20px 0 20px 0",float:"left"}},[a("el-button",[e._v("取消选择")]),e._v(" "),a("el-button",[e._v("批量删除")])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(o,l,!1,function(e){a("Y7Bk")},"data-v-09795b1d",null);t.default=r.exports},tqLV:function(e,t,a){var o={"./AdminIndex.vue":"akyf","./AdminMenu.vue":"Ofww","./Header.vue":"JtNw","./content/ArticleEditor.vue":"DNt1","./content/ArticleManagement.vue":"yA7P","./content/BannerManagement.vue":"VcZY","./content/BookManagement.vue":"8zNu","./content/EditForm.vue":"EYD5","./content/ImgUpload.vue":"1vuj","./dashboard/admin/components/BarChart.vue":"p6nP","./dashboard/admin/components/BoxCard.vue":"39LR","./dashboard/admin/components/LineChart.vue":"jutt","./dashboard/admin/components/PanelGroup.vue":"gVcc","./dashboard/admin/components/PieChart.vue":"AbWr","./dashboard/admin/components/RaddarChart.vue":"uYnh","./dashboard/admin/components/TodoList/Todo.vue":"SxUx","./dashboard/admin/components/TodoList/index.vue":"WBdT","./dashboard/admin/components/TransactionTable.vue":"kbyp","./dashboard/admin/index.vue":"R/lB","./user/BulkRegistration.vue":"VQCX","./user/Role.vue":"pmqU","./user/RoleCreate.vue":"cdRC","./user/UserProfile.vue":"0U9i"};function l(e){return a(r(e))}function r(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}l.keys=function(){return Object.keys(o)},l.resolve=r,e.exports=l,l.id="tqLV"},yA7P:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={name:"ArticleManagement",data:function(){return{articles:[],pageSize:10,total:0}},mounted:function(){this.loadArticles()},computed:{tableHeight:function(){return window.innerHeight-320}},methods:{loadArticles:function(){var e=this;this.$axios.get("/article/"+this.pageSize+"/1").then(function(t){t&&200===t.data.code&&(e.articles=t.data.result.content,e.total=t.data.result.totalElements)})},handleCurrentChange:function(e){var t=this;this.$axios.get("/article/"+this.pageSize+"/"+e).then(function(e){e&&200===e.data.code&&(t.articles=e.data.result.content,t.total=e.data.result.totalElements)})},viewArticle:function(e){var t=this.$router.resolve({path:"../../jotter/article",query:{id:e}});window.open(t.href,"_blank")},editArticle:function(e){this.$router.push({name:"Editor",params:{article:e}})},deleteArticle:function(e){var t=this;this.$confirm("此操作将永久删除该文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.delete("/admin/content/article/"+e).then(function(e){e&&200===e.data.code&&t.loadArticles()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticStyle:{margin:"18px 0px 0px 18px"}},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/admin/dashboard"}}},[e._v("管理中心")]),e._v(" "),a("el-breadcrumb-item",[e._v("内容管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("文章管理")])],1)],1),e._v(" "),a("el-link",{staticClass:"add-link",attrs:{href:"/admin/content/editor",underline:!1,target:"_blank"}},[a("el-button",{attrs:{type:"success"}},[e._v("写文章")])],1),e._v(" "),a("el-card",{staticStyle:{margin:"18px 2%",width:"95%"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.articles,stripe:"","max-height":e.tableHeight}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{attrs:{"label-position":"left",inline:""}},[a("el-form-item",[a("span",[e._v(e._s(t.row.articleAbstract))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"articleTitle",label:"题目（展开查看摘要）",fit:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"articleDate",label:"发布日期",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.viewArticle(t.row.id)}}},[e._v("\n            查看\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.editArticle(t.row)}}},[e._v("\n            编辑\n          ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteArticle(t.row.id)}}},[e._v("\n            移除\n          ")])]}}])})],1),e._v(" "),a("div",{staticStyle:{margin:"20px 0 50px 0"}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{background:"",layout:"total, prev, pager, next, jumper","page-size":e.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(o,l,!1,function(e){a("phcO")},"data-v-0eda4cf0",null);t.default=r.exports}});
//# sourceMappingURL=0.e84070b6b133dcb5036d.js.map